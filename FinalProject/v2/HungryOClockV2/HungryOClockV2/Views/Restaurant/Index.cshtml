@model IEnumerable<Restaurant>
@{
	ViewBag.Title = "Manage Restaurants";
}

<h2>Manage Restaurants</h2>

@if(TempData["message"] != null)
{
	<div class="alert alert-success">@TempData["message"]</div>
}

<p>
	<a asp-action="Create" class="btn btn-primary">Add Restaurant</a>
</p>

<table class="table table-striped">
	<thead>
		<tr>
			<th>Name</th>
			<th>Price Level</th>
			<th>Category</th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		@foreach(var r in Model)
		{
			<tr>
				<td>@r.Name</td>
				<td>@r.PriceLevel</td>
				<td>
					@{
						var cats = r.RestaurantCategories?.Select(rc => rc.Category.Name).Where(n => !string.IsNullOrEmpty(n)) ?? Enumerable.Empty<string>();
					}
					@string.Join(", ", cats)
				</td>
				<td>
					<a asp-action="Details" asp-route-slug="@r.Slug" class="btn btn-outline-primary">Details</a>
					<a asp-action="Edit" asp-route-id="@r.RestaurantId" class="btn btn-outline-secondary">Edit</a>

					<form asp-action="Delete" asp-route-id="@r.RestaurantId" method="post" class="d-inline">
						@Html.AntiForgeryToken()
						<button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this?');">Delete</button>
					</form>
				</td>
			</tr>
		}
	</tbody>
</table>